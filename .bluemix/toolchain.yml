version: '2'
template:
  name: "DYML: $switch/$case construct"
  description: "DYML: $switch/$case construct"
  required:
    - sample-repo

  info:
    git url: >-
      $env.repository ? '[' + $env.repository + '](' + $env.repository + ')' : "[https://github.com/tonymcguckin/dynamicyml](https://github.com/tonymcguckin/dynamicyml)"
    git branch: >-
      $env.repository && $env.branch ? '[' + $env.branch + ']('+ $env.repository + '/tree/' + $env.branch + ')': "[flavour9](https://github.com/tonymcguckin/dynamicyml/tree/flavour9)"

  info2:
    git url: >-
      '[' + $env.repository + '](' + $env.repository + ')'
    git branch: >-
      '[' + $env.branch + ']('+ $env.repository + '/tree/' + $env.branch + ')'

  info3:
    git url: "'[' + $env.repository + '](' + $env.repository + ')'"
    git branch: "'[' + $env.branch + ']('+ $env.repository + '/tree/' + $env.branch + ')'"

toolchain:
  name: 'DYML: $switch/$case construct'

services:

  # dynamic yml 'service' entry...
  sample-repo:

    $switch:

      - $expr: $env.expr
  
      - $default: "a"
        service_id: default_service
        parameters:
          branch: $env.branch
          expr: $env.expr
  
      - $case: "b"
        service_id: b_case_service
        parameters:
          branch: $env.branch
          expr: $env.expr
  
      - $case: "c"
        service_id: c_case_service
        parameters:
          branch: $env.branch
          expr: $env.expr
  
      - $case: "undefined"
        service_id: undefined_service
        parameters:
          branch: $env.branch
          expr: $env.expr

form:
  pipeline:
    parameters: {}
    schema: {}
