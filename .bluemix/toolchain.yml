version: '2'

template:

  name: "DYML - switch construct as Binary operator"

  description: "DYML - switch construct as Binary operator"
  required:
    - build
    - frontend-repo
    - sample-repo
  info:
    git url: "'[' + $env.repository + '](' + $env.repository + ')'"
    git branch: "'[' + $env.branch + ']('+ $env.repository + '/tree/' + $env.branch + ')'"

toolchain:
  name: 'DYML - switch construct as Binary operator'

services:

  sample-repo:
    $switch:
      - $expr: $env.case
      - $case: true
        service_id: bitbucket
        parameters:
          test: $env.branch

  # dynamic yml 'service' entry...
  #sample-repo:

  #  $switch:

   #   #- $expr: "$env.case === undefined ? 'gritty' : $env.case"
    #  - $expr: $env.case
  #
   #   - $case: "undefined"
  #
   #   - $case: "bitbucket"
#        service_id: bitbucket
 #       parameters:
  #        test: $env.branch
  #
   #   - $case: "github"
    #    service_id: github
     #   parameters:
      #    test: $env.branch
  #
   #   - $case: "gitlab"
    #    service_id: gitlab
     #   parameters:
      #    test: $env.branch

form:
  pipeline:
    parameters:
      username: 'admin'
      group: 'system'
    schema:
      $ref: deploy.json
